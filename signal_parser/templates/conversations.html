b <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Signal Messenger</title>
    <link rel="icon" type="image/png" sizes="30x30" href="data:image/png;base64,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" />
<style>
body { margin: 0; }
.navbar { overflow: hidden; background-color: #3974ed; position: fixed; top: 0; width: 100%; color: white; }
.navbar a { float:left; display: block; color: white; text-align: center; padding: 10px 10px; text-decoration: none; font-family: "Calibri"; }
.navbar a:hover { background: white; color: #3974ed; }
.title { color: #3974ed; font-family: "Calibri"; position: fixed; margin-top: 21px; background: white; width: 100%; margin-left: 5px; vertical-align: bottom; padding-top: 2px; padding-bottom: 2px; border-bottom: solid #3974ed; }
.main { margin-top: 100px; margin-left: 5px; }
.members { color: black; font-family: "Calibri"; font-weight: bold; }
table { border-spacing: 0 6px; border: 0; font-family: "Calibri"; }
.t1 tr:nth-child(even) { background-color: #eee; }
.t2 tr:hover { color: white; background: black; }
.t2 tr.msg.rcvd { color: #777; }
.t2 tr.msg.sent { color: black; }
td { word-break: break-all; text-align: left; padding: 0.2rem; padding-right: 0.3rem; vertical-align: middle; }
th { word-break: break-all; text-align: left; padding: 0.2rem; padding-right: 0.3rem; vertical-align: text-top; border-bottom: 0.15rem solid black; }
td.nowrap { white-space: nowrap; text-align: left; padding: 0.17rem; padding-right: 0.3rem; vertical-align: middle; }
td.msg { position: static; padding: 4px 15px; vertical-align: middle; }
td.msg.sent { word-break: break-all; text-align: left; vertical-align: middle; border-radius: 20px 20px 20px 20px; background: #3974ed; color: white; display: inline; line-height: 150%; }
td.msg.sent.attachment { word-break: break-all; text-align: left; vertical-align: middle; border-radius: 20px 20px 20px 20px; background: #3974ed; color: white; padding-top: 30px; }
td.msg.sent.noimg { word-break: break-all; text-align: left; vertical-align: middle; border-radius: 20px 20px 20px 20px; background: #3974ed; color: white; display: inline; line-height: 150%; }
td.msg.rcvd { word-break: break-all; text-align: left; vertical-align: middle; border-radius: 20px 20px 20px 20px; background: #e9e9e9; color: black; display: inline; line-height: 150%; }
td.msg.rcvd.attachment { word-break: break-all; text-align: left; vertical-align: middle; border-radius: 20px 20px 20px 20px; background: #e9e9e9; color: black; padding-top: 30px; }
td.msg.rcvd.noimg { word-break: break-all; text-align: left; vertical-align: middle; border-radius: 20px 20px 20px 20px; background: #e9e9e9; color: black; display: inline; line-height: 150%; }
td.msg.other { word-break: break-all; text-align: left; vertical-align: middle; border-radius: 20px 20px 20px 20px; background: green; color: white; display: inline; line-height: 150%; }
td a:link { color: black; font-family: "Calibri"; }
td a:hover { color: green; }
td a:active { color: black; font-family: "Calibri"; }
tr.msg.rcvd:hover { color: white; background: black; }
tr.msg.rcvd.attachment:hover { color: white; background: black; }
tr.msg.rcvd.noimg:hover { color: white; background: black; }
tr.msg.sent:hover { color: white; background: black; }
tr.msg.sent.attachment:hover { color: white; background: black; }
tr.msg.sent.noimg:hover { color: white; background: black; }
li { color: #3974ed; font-family: "Calibri"; list-style-type: none; }
li a:link { color: #3974ed; font-family: "Calibri"; }
li a:hover { color: green; }
li a:active { color: #3974ed; font-family: "Calibri"; }
img { vertical-align: bottom; width: 48px; height: 48px; border-radius: 10px; margin-right: 10px; }
</style>
</head>
<body>
<div class="navbar"><a href="/">Home</a><a href="device.html">Signal Device Info</a><a href="attachments.html">All Attachments</a><a href="applogs.html">App Logs</a><a href="mainlogs.html">Main Logs</a><a href="#">Top</a></div>
{% if "PRIVATE" in contact_name[4] and contact_name[8]|length %}
{% set profile_avatar = "static/" + contact_name[8]["path"] %}
<h1 class="title"><img src="{{ profile_avatar }}" style="width:52px;height:52px;border-radius:50%;vertical-align:bottom;">Conversation with {{ contact_name[0] }} - {{ contact_name[1] }} {{ contact_name[2] }} - {{ contact_name[3] }} - {{ contact_name[4] }} - {{ contact_name[5] }} messages - {{ contact_name[6] }} sent</h1>
{% elif "GROUP" in contact_name[4] and contact_name[9]|length %}
{% set profile_avatar = "static/" + contact_name[9]["path"] %}
<h1 class="title"><img src="{{ profile_avatar }}" style="width:52px;height:52px;border-radius:50%;vertical-align:bottom;">Conversation with {{ contact_name[0] }} - {{ contact_name[1] }} {{ contact_name[2] }} - {{ contact_name[3] }} - {{ contact_name[4] }} - {{ contact_name[5] }} messages - {{ contact_name[6] }} sent</h1>
{% else %}
<h1 class="title">Conversation with {{ contact_name[0] }} - {{ contact_name[1] }} {{ contact_name[2] }} - {{ contact_name[3] }} - {{ contact_name[4] }} - {{ contact_name[5] }} messages - {{ contact_name[6] }} sent</h1>
{% endif %}
<div class="main">
{% set type = contact_name[4] %}
{% if "GROUP" in type %}
  <table class="t1">
  <caption class="members">GROUP MEMBERS</caption>
  <colgroup>
  <col span="1" style="width:25%;">
  <col span="1" style="width:25%;">
  <col span="1" style="width:25%;">
  </colgroup>
  <tr>
    <th>Full Name</th>
    <th>First / Last</th>
    <th>E.164</th>
  </tr>
  {% for dict in contact_name[10] %}
    {% set uuid = dict['uuid'] %}
    {% for k, v in contacts.items() %}
      {% if uuid == v[12] %}
        <tr>
        <td>{{ v[0] }}</td>
        <td>{{ v[1] }} {{ v[2] }}</td>
        <td>{{ v[3]}}</td>
        </tr>
      {% endif %}
    {% endfor %}
  {% endfor %}
</table>
{% endif %}
<p>
{% if device_number in contact_name[3] and contact_name[7]|length %}
  {% for k, v in contact_name[7].items() %}
    <li><a href="{{ url_for('static', filename=v) }}">Avatar {{ k }}: {{ v }}</a></li>
  {% endfor %}
{% endif %}
{% if contact_name[8]|length %}
  {% set path = contact_name[8]["path"] %}
    <li><a href="{{ url_for('static', filename=path) }}">Profile Avatar path: {{ path }}</a></li><p>
{% endif %}
{% if "GROUP" in type %}
  {% set path = contact_name[9]["path"] %}
    <li><a href="{{ url_for('static', filename=path) }}">Group Avatar path: {{ path }}</a></li><p>
{% endif %}
<table class="t2">
<tr>
  <th>Date/Time UTC</th>
  <th>Contact</th>
  <th>Message body / Attachment</th>
</tr>
{% for msg in messages %}
  {% set sender_uuid = msg.sourceUuid %}
  {% set sender = contact_name[0] %}
  {% if msg.conversationId == contact %}
    {% if msg.type == 'incoming' %}
      {% for k, v in contacts.items() %}
        {% if sender_uuid == v[12] %}
          {% if v[0] == "" %}
          {% set sender = v[1] + " " + v[2] %}
          {% elif (v[1] == "" and v[2] == "") and v[0] != "" %}
          {% set sender = v[0] %}
          {% elif v[0] != "" and (v[1] == "" or v[2] == "") %}
          {% set sender = v[0] %}
          {% elif v[0] != "" and v[1] != "" and v[2] != "" %}
          {% set sender = v[0] %}
          {% else %}
          {% set sender = v[0] + " - " + v[1] + " " + v[2] %}
          {% endif %}
      {% if msg.hasAttachments|string() == '1'  %}
        <tr class="msg rcvd">
        <td class="nowrap">{{ msg.SentUTC }}</td><td class="nowrap">{{ sender }}</td><td class="msg rcvd">{{ msg.body }}</td>
        {% for a in msg.Attachments %}
          {% if msg.AttachmentDetails["contentType"].split('/')[0] == "image" %}
          {% set class = "msg rcvd attachment" %}
          {% else %}
          {% set class = "msg rcvd noimg" %}
          {% endif %}
          <tr class="{{ class }}">
          <td></td><td></td><td class="{{ class }}"><a style="color:black;" href="{{ url_for('static', filename=a) }}">
          {% if msg.AttachmentDetails["contentType"].split('/')[0] == "image" %}
            <img src="static/{{ a }}">
          {% endif %}
          {{ a }}</a> Content Type: {{ msg.AttachmentDetails["contentType"] }} Size: {{ msg.AttachmentDetails["size"] }} - File Name: {{ msg.AttachmentDetails["fileName"] }}</td><tr></tr>
          </tr>
        {% endfor %}
        </tr>
      {% elif msg.hasAttachments|string() == '0' %}
        <tr class="msg rcvd">
        <td class="nowrap">{{ msg.SentUTC }}</td><td class="nowrap">{{ sender }}</td><td class="msg rcvd">{{ msg.body }}</td>
        </tr>
        {% endif %}
      {% endif %}
      {% endfor %}
    {% elif msg.type == 'outgoing' %}
      {% if msg.hasAttachments|string() == '1' %}
        <tr class="msg sent">
        <td class="nowrap">{{ msg.SentUTC }}</td><td class="nowrap">{{ device_number }}</td><td class="msg sent">{{ msg.body }}</td>
        {% for a in msg.Attachments %}
          {% if msg.AttachmentDetails["contentType"].split('/')[0] == "image" %}
          {% set class = "msg sent attachment" %}
          {% else %}
          {% set class = "msg sent noimg" %}
          {% endif %}
          <tr class="{{ class }}">
          <td></td><td></td><td class="{{ class }}"><a style="color:white;" href="{{ url_for('static', filename=a) }}">
          {% if msg.AttachmentDetails["contentType"].split('/')[0] == "image" %}
            <img src="static/{{ a }}">
          {% endif %}
          {{ a }}</a> Content Type: {{ msg.AttachmentDetails["contentType"] }} Size: {{ msg.AttachmentDetails["size"] }} - File Name: {{ msg.AttachmentDetails["fileName"] }}</td><tr></tr>
          </tr>
        {% endfor %}
      </tr>
      {% elif msg.hasAttachments|string() == '0' %}
        <tr class="msg sent">
        <td class="nowrap">{{ msg.SentUTC }}</td><td class="nowrap">{{ device_number }}</td><td class="msg sent">{{ msg.body }}</td>
        </tr>
       {% endif %}
    {% else %}
      {% set mode = msg.body.callMode %}
      {% if msg.body.wasIncoming == true %}
        {% set direction = "incoming" %}
      {% elif msg.body.wasIncoming == false %}
        {% set direction = "outgoing" %}
      {% endif %}
      {% if msg.body.wasVideoCall == true %}
        {% set calltype = "video call" %}
      {% elif msg.body.wasVideoCall == false %}
        {% set calltype = "audio call" %}
      {% endif %}
      {% if msg.body.wasDeclined == true %}
        {% set answered = "which was declined" %}
      {% elif msg.body.wasDeclined == false  %}
        {% set answered = "which was accepted" %}
      {% endif %}
      {% if msg.body.acceptedTime != "" %}
        {% set accepted_time = "at " + msg.body.acceptedTime %}
      {% else %}
        {% set accepted_time = "" %}
      {% endif %}
      {% if msg.body.endedTime != "" %}
        {% set ended_time = "and ended at " + msg.body.endedTime %}
      {% else %}
        {% set ended_time = "and does not have an ended time." %}
      {% endif %}
       <tr>
       <td class="nowrap">{{ msg.SentUTC }}</td><td class="nowrap">{{ device_number }}</td><td class="msg other">{{ mode }} {{ direction }} {{ calltype }} {{ answered }} {{ accepted_time }} {{ ended_time }}</td>
       </tr>
    {% endif %}
  {% endif %}
{% endfor %}
</table>
</div>
</body>
</html>
